setwd("~/Documents/GitHub/MCMC_IS/Examples/Poisson_random_effects_model")
source("Poisson_functions.R")
rowMeans(data)+1
eta_start <- log(rowMeans(data)+1)
eta_start
eta_start <- log(1e4*rowMeans(data)+1)
eta_start
eta_start <- log(rowMeans(data)+1e4)
eta_start
eta_start <- log(1e4*rowMeans(data)+1e4)
eta_start
eta_start <- log(1e4*rowMeans(data)+1e8)
eta_start
eta_start <- log(rowMeans(data)+1)+1e5
eta_start <- log(rowMeans(data)+1)+1e3
eta_start
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+1e3
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
isbark <- mybarker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_mybark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
isbark <- mybarker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_mybark, data)
######## Poisson random effects run ##########
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+1e2
mu_start <- mean(eta_start)
iter <- 1e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
isbark <- mybarker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_mybark, data)
######## Poisson random effects run ##########
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+1e2
mu_start <- mean(eta_start)
iter <- 1e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 0.12
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 0.00012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 0.000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 0.000000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
isbark <- mybarker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_mybark, data)
pxbark <- px.barker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_pxbark, data)
log_p(eta_start, mu_start, data = )
log_p(eta_start, mu_start, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+1e2
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 0.0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 2
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)
mu_start <- mean(eta_start)
iter <- 1e5
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+10
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
plot.ts(true_bark[[1]][,c(1:10)])
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
plot.ts(true_bark[[1]][,c(1:10)])
plot.ts(true_bark[[1]][,c(1:10)])
plot.ts(true_bark[[1]][,c(11:20)])
plot.ts(true_bark[[1]][,51)
plot.ts(true_bark[[1]][,51])
######## Poisson random effects run ##########
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+5
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .0012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- .000000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- .000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- .000015
delta_bark <- .00012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .00000012
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- .00000001
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- .00000000001
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 1e-20
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+50
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 1e-50
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+10
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 1e-50
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+10
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 1e-5
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+10
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 1e-15
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 1e-10
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 1e-9
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 5e-10
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 2e-10
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
plot.ts(true_bark[[1]][,c(1:10)])
plot.ts(true_bark[[1]][,c(21:30)])
plot.ts(true_bark[[1]][,51])
######## Poisson random effects run ##########
source("Poisson_functions.R")
lambda <- 0.001
eta_start <- log(rowMeans(data)+1)+30
mu_start <- mean(eta_start)
iter <- 5e4
delta_mym <- 0.0032
delta_pxm <- 0.00065
delta_mybark <- 0.003
delta_pxbark <- 0.0006
delta_bark <- 2e-30
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
delta_bark <- 1e-30
true_bark <- barker(eta_start,mu_start,sigma_eta,iter = iter, delta = delta_bark, data)
plot.ts(true_bark[[1]][,c(1:10)])
plot.ts(true_bark[[1]][,c(11:20)])
plot.ts(true_bark[[1]][,c(21:30)])
plot.ts(true_bark[[1]][,c(31:40)])
plot.ts(true_bark[[1]][,c(41:50)])
plot.ts(true_bark[[1]][,51])
delta_pxbark <- 6e-25
pxbark <- px.barker(eta_start, mu_start, lambda, sigma_eta, iter = iter, delta = delta_pxbark, data)
plot.ts(true_bark[[1]][,c(1:10)])
plot.ts(px_bark[[1]][,c(1:10)])
plot.ts(pxbark[[1]][,c(1:10)])
plot.ts(pxbark[[1]][,c(11:20)])
plot.ts(pxbark[[1]][,c(21:30)])
plot.ts(pxbark[[1]][,51])
# Data generation
# Generating the CheckerBoard Image
set.seed(8024248)
n <- 16
a <- 4
mat <- matrix(0, nrow = n, ncol = n)
vec.mat <- rep(c(1, 0), each = a, times = n/(2*a))
checker <- matrix(0, nrow = n, ncol = n)
for(j in seq(1, n/2, by = a))
{
for(k in 1:a)
{
checker[j+k-1, ] <- vec.mat
}
vec.mat <- rev(vec.mat)
}
for(j in seq((n/2+1), n, by = a))
{
for(k in 1:a)
{
checker[j+k-1, ] <- (vec.mat == 0)*(vec.mat)  + (vec.mat == 1)*(vec.mat - .50)
}
vec.mat <- rev(vec.mat)
}
noise <- matrix(rnorm(n^2, 0, sqrt(0.01)), nrow = n, ncol = n)
image_mat <- checker + noise
image(checker, col = gray.colors(4, start = 0, end = 1), axes = FALSE)
